<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>MK Electric - CAD REBT</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com"></script>
</head>
<body class="bg-slate-900 text-slate-200 overflow-hidden">
    <header class="h-16 bg-slate-800 border-b border-slate-700 flex items-center justify-between px-6">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center font-bold text-yellow-500 border-2 border-slate-400">MK</div>
            <h1 class="font-bold">MK <span class="text-yellow-500">ELECTRICAL</span></h1>
        </div>
        <button onclick="canvas.clear(); canvas.backgroundColor='#fff'; canvas.renderAll()" class="bg-red-600 px-3 py-1 rounded text-xs">Limpiar Todo</button>
    </header>

    <main class="flex h-[calc(100vh-64px)]">
        <!-- Columna Eléctrica -->
        <aside class="w-64 bg-slate-800 p-4 border-r border-slate-700 space-y-4">
            <h2 class="text-xs font-bold text-slate-400 uppercase">Protecciones y Tomas</h2>
            <div class="grid grid-cols-2 gap-2">
                <button onclick="addObj('IGA', '#ef4444')" class="bg-slate-700 p-2 rounded text-xs hover:bg-slate-600">IGA</button>
                <button onclick="addObj('ID', '#f59e0b')" class="bg-slate-700 p-2 rounded text-xs hover:bg-slate-600">ID</button>
                <button onclick="addObj('C1 (Luz)', '#3b82f6')" class="bg-blue-900 p-2 rounded text-xs">C1 (Luz)</button>
                <button onclick="addObj('C2 (Toma)', '#10b981')" class="bg-green-900 p-2 rounded text-xs">C2 (Toma)</button>
            </div>
            <h2 class="text-xs font-bold text-slate-400 uppercase pt-4">Cables (REBT)</h2>
            <button onclick="startLine('#92400e')" class="w-full bg-amber-800 p-2 rounded text-xs text-left">Fase (Marrón)</button>
            <button onclick="startLine('#1e40af')" class="w-full bg-blue-800 p-2 rounded text-xs text-left">Neutro (Azul)</button>
            <button onclick="startLine('#166534')" class="w-full bg-green-800 p-2 rounded text-xs text-left">Tierra (V/A)</button>
        </aside>

        <!-- Área de Trabajo -->
        <section class="flex-1 bg-slate-700 p-4 flex justify-center items-center relative">
            <canvas id="c" class="shadow-2xl"></canvas>
            <div id="tip" class="absolute bg-black/80 p-2 rounded text-[10px] hidden pointer-events-none"></div>
        </section>

        <!-- Columna Arquitectura -->
        <aside class="w-64 bg-slate-800 p-4 border-l border-slate-700">
            <h2 class="text-xs font-bold text-slate-400 uppercase mb-4">Arquitectura</h2>
            <button onclick="addWall()" class="w-full bg-slate-600 p-2 rounded text-xs mb-2 italic">Dibujar Pared (m)</button>
        </aside>
    </main>

    <script>
        const canvas = new fabric.Canvas('c', { width: 800, height: 600, backgroundColor: '#fff' });
        const tip = document.getElementById('tip');

        // Función para añadir componentes
        function addObj(type, color) {
            const group = new fabric.Group(, { left: 100, top: 100, data: { info: `REBT: ${type}` } });
            canvas.add(group);
        }

        // Función para cables
        function startLine(color) {
            const line = new fabric.Line([50, 50, 200, 50], {
                stroke: color, strokeWidth: 3, data: { info: `Cable sección según REBT` }
            });
            canvas.add(line);
        }

        // Función Pared con Medida
        function addWall() {
            const wall = new fabric.Rect({ 
                left: 200, top: 200, width: 200, height: 10, fill: '#334155',
                data: { info: 'Pared: 2.00 metros' }
            });
            canvas.add(wall);
        }

        // Mostrar Info al pasar el ratón (Hover)
        canvas.on('mouse:over', (e) => {
            if (e.target && e.target.data) {
                tip.style.display = 'block';
                tip.innerHTML = e.target.data.info;
                tip.style.left = (e.e.clientX - 200) + 'px';
                tip.style.top = (e.e.clientY - 100) + 'px';
            }
        });
        canvas.on('mouse:out', () => tip.style.display = 'none');
    </script>
</body>
</html>
